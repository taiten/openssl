Index: openssl-0.9.8k/ssl/d1_both.c
===================================================================
--- openssl-0.9.8k.orig/ssl/d1_both.c	2009-07-19 11:32:41.000000000 +0200
+++ openssl-0.9.8k/ssl/d1_both.c	2009-07-19 11:37:42.000000000 +0200
@@ -530,13 +530,14 @@
 				frag->fragment,frag->msg_header.frag_len);
 			}
 
+		unsigned long frag_len = frag->msg_header.frag_len;
 		dtls1_hm_fragment_free(frag);
 		pitem_free(item);
 
 		if (al==0)
 			{
 			*ok = 1;
-			return frag->msg_header.frag_len;
+			return frag_len;
 			}
 
 		ssl3_send_alert(s,SSL3_AL_FATAL,al);
