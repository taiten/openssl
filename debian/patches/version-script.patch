Index: openssl-0.9.8k/Configure
===================================================================
--- openssl-0.9.8k.orig/Configure	2009-07-19 11:36:28.000000000 +0200
+++ openssl-0.9.8k/Configure	2009-07-19 11:36:28.000000000 +0200
@@ -1479,6 +1479,8 @@
 	$shlib_minor=$2;
 	}
 
+$shared_ldflag .= " -Wl,--version-script=openssl.ld";
+
 open(IN,'<Makefile.org') || die "unable to read Makefile.org:$!\n";
 unlink("$Makefile.new") || die "unable to remove old $Makefile.new:$!\n" if -e "$Makefile.new";
 open(OUT,">$Makefile.new") || die "unable to create $Makefile.new:$!\n";
Index: openssl-0.9.8k/openssl.ld
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ openssl-0.9.8k/openssl.ld	2009-07-19 11:36:28.000000000 +0200
@@ -0,0 +1,5 @@
+OPENSSL_0.9.8 {
+	 global:
+		 *;
+};
+
Index: openssl-0.9.8k/engines/openssl.ld
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ openssl-0.9.8k/engines/openssl.ld	2009-07-19 11:36:28.000000000 +0200
@@ -0,0 +1,5 @@
+OPENSSL_0.9.8 {
+	 global:
+		 *;
+};
+
